const gridEl=document.getElementById("grid"),acrossList=document.getElementById("across-list"),downList=document.getElementById("down-list"),timerEl=document.getElementById("timer"),winnerForm=document.getElementById("winner-form"),nameInput=document.getElementById("player-name"),lbLocal=document.getElementById("lb-local");let PUZ=getPuzzleById("mini-001"),size=PUZ.size,inputs=[],timerMs=0,ticker=null,done=false;function buildGrid(){gridEl.innerHTML="";gridEl.style.gridTemplateColumns=`repeat(${size},40px)`;inputs=[];for(let r=0;r<size;r++){const row=[];for(let c=0;c<size;c++){const cell=document.createElement("div");cell.className="cell";const inp=document.createElement("input");inp.maxLength=1;inp.addEventListener("input",()=>{inp.value=inp.value.toUpperCase();if(!ticker)startTimer();checkSolved();});cell.appendChild(inp);gridEl.appendChild(cell);row.push(inp);}inputs.push(row)}}function renderClues(){acrossList.innerHTML="";for(const A of PUZ.across){const li=document.createElement("li");li.textContent=A.num+". "+A.clue;acrossList.appendChild(li)}downList.innerHTML="";for(const D of PUZ.down){const li=document.createElement("li");li.textContent=D.num+". "+D.clue;downList.appendChild(li)}}function checkSolved(){for(let r=0;r<size;r++){for(let c=0;c<size;c++){if(PUZ.grid[r][c]!==inputs[r][c].value)return}}if(!done){done=true;stopTimer();winnerForm.classList.remove("hide")}}function startTimer(){const t0=performance.now();ticker=setInterval(()=>{timerMs=performance.now()-t0;timerEl.textContent=mmss(timerMs)},100)}function stopTimer(){clearInterval(ticker);ticker=null}function mmss(ms){const s=Math.floor(ms/1000);const m=Math.floor(s/60);return m.toString().padStart(2,"0")+":"+(s%60).toString().padStart(2,"0")}winnerForm.addEventListener("submit",e=>{e.preventDefault();lbLocal.textContent="Finished in "+mmss(timerMs)+" by "+nameInput.value;winnerForm.classList.add("hide")});buildGrid();renderClues();